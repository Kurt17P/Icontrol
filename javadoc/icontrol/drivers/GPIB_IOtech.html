<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (1.8.0_25) on Sat Feb 06 22:02:51 CET 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>GPIB_IOtech (Instrument Control (iC))</title>
<meta name="date" content="2016-02-06">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="GPIB_IOtech (Instrument Control (iC))";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/GPIB_IOtech.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../icontrol/drivers/GPIB_NI.html" title="class in icontrol.drivers"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?icontrol/drivers/GPIB_IOtech.html" target="_top">Frames</a></li>
<li><a href="GPIB_IOtech.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">icontrol.drivers</div>
<h2 title="Class GPIB_IOtech" class="title">Class GPIB_IOtech</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">icontrol.drivers.GPIB_Driver</a></li>
<li>
<ul class="inheritance">
<li>icontrol.drivers.GPIB_IOtech</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">GPIB_IOtech</span>
extends <a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></pre>
<div class="block">This class provides access to the IOtech Micro488/A-901 RS232-GPIB 
 controller.<p>
 
 Note: The at-character (@) has a special meaning (clear the serial input). If 
 the commands/data contain the at-character, it should be disabled using the 
 ID command.<p>
 
 Note on DIP switch settings in the Micro 488:<br>
 The Micro488 is assumed to be the System Controller (SW2-1,2: on, on)<br>
 Serial echoing should be disabled (SW 2-5: on)<br>
 Serial handshaking can likely be set to hardware (SW 1-5: on) if a 5-wire
 cable is used.<br>
 IEEE terminator selection depends on the instruments, CR+LF and EOI disabled
 is recommended (SW3-6,7,8: off, off, on)<br>
 A baud rate of 9600 is recommended to begin with (SW 1-1,2,3,4: off, on, off, off<br>
 8 data bits are recommended (SW 1-6: on)<br>
 2 stop bit are recommended (SW 1-8: off)<br>
 no parity is recommended (SW 2-6: on)<br>
 IEEE address can be chosen arbitrarily, but address 30 is recommended 
 (SW 3-1,2,3,4,5: off, on, on, on, on)<br>
 Choose the proper signal levels (RS232 or RS422), most likely you have RS232,
 so the jumper needs to be in J206<br>
 <p>
 

 <h3>Usage / How this class works:</h3>
 <ul>
  <li>Instantiate the class. The constructor calls <code>OpenRS232</code>.
  <li><code>OpenRS232</code> establish access to the RS232 serial port, and 
      then calls <code>InitIOtech</code>.
  <li>Open an Instrument at a specific GPIB address using <code>Open</code>,
      which stores the GPIB address and sends a Selected-Device-Clear to the
      Instrument at the specified GPIB address.
  <li>To send/receive data use <code>SendCommand</code> and <code>Receive</code>.
  <li>To close the connection to an Instrument call <code>CloseInstrument</code>.
  <li>Once done with all GPIB communication, close the connection to the
      GPIB controller with <code>CloseController</code>.
  <li>To receive the Status Byte - especially of older equipment that is not
      488.2 compliant but implements 488 only, hence, no *STB? command -
      <code>ReadStatusByte</code> can be used.
 </ul></div>
<dl>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>0.1</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>KPP (Kurt Pernstich: pernstich@alumni.ethz.ch)</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#m_GPIB_Adr">m_GPIB_Adr</a></span></code>
<div class="block">GPIB Address of the Instrument</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static <a href="../../icontrol/iC_Properties.html" title="class in icontrol">iC_Properties</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#m_iC_Properties">m_iC_Properties</a></span></code>
<div class="block">Grants access to global properties in a resource bundle file 'iC.properties'</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#m_IOtechDebug">m_IOtechDebug</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#m_LastError">m_LastError</a></span></code>
<div class="block">Stores the status (error) of the last communication with the IOtech
 controller.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.util.logging.Logger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#m_Logger">m_Logger</a></span></code>
<div class="block">The Logger for this class</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../icontrol/drivers/RS232_Driver.html" title="class in icontrol.drivers">RS232_Driver</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#m_RS232Driver">m_RS232Driver</a></span></code>
<div class="block">Handle to access the RS232 port</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.icontrol.drivers.GPIB_Driver">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;icontrol.drivers.<a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></h3>
<code><a href="../../icontrol/drivers/GPIB_Driver.html#m_Comm_Logger">m_Comm_Logger</a>, <a href="../../icontrol/drivers/GPIB_Driver.html#m_GUI">m_GUI</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#GPIB_IOtech--">GPIB_IOtech</a></span>()</code>
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#checkCommunicationError-java.lang.String-">checkCommunicationError</a></span>(java.lang.String&nbsp;Msg)</code>
<div class="block">Checks the Status of the last communication with the IOtech controller
 and throws an Exception if an error occurred.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#CloseController--">CloseController</a></span>()</code>
<div class="block">Closes the connection to the GPIB controller by closing the RS232 port.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#CloseInstrument--">CloseInstrument</a></span>()</code>
<div class="block">Closes the connection to the Instrument specified in <code>Open</code>.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#getGPIBStatus--">getGPIBStatus</a></span>()</code>
<div class="block">Returns the status of the last communication with the IOtech controller.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#InitIOtech--">InitIOtech</a></span>()</code>
<div class="block">Initializes the IOtech Micro 488 GPIB-RS232 controller to it's power-on
 state (command @@), becomes controller-in-charge (ABORT).</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#Open-int-">Open</a></span>(int&nbsp;GPIB_Address)</code>
<div class="block">Opens the connection to the Instrument at the specified GPIB address.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#OpenRS232--">OpenRS232</a></span>()</code>
<div class="block">Opens the RS232 port using the parameters defined in 
 <code>iC.Properties</code>.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#ReadFromIOtech--">ReadFromIOtech</a></span>()</code>
<div class="block">Read data from the IOtech GPIB-RS232 controller until no more data was 
 received via RS232 for a time-out period specified in 
 <code>iC.properties / RS232_Driver.TimeOut</code>.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#ReadStatusByte--">ReadStatusByte</a></span>()</code>
<div class="block">Reads the Status Byte of the Instrument defined in <code>Open</code>
 by serially polling the Instrument.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#Receive-boolean-">Receive</a></span>(boolean&nbsp;Trim)</code>
<div class="block">Receives data from the Instrument specified in <code>Open</code>.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#Send-java.lang.String-">Send</a></span>(java.lang.String&nbsp;Msg)</code>
<div class="block">Sends the given String via the GPIB bus to the Instrument specified in
 <code>Open</code>.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../icontrol/drivers/GPIB_IOtech.html#WriteToIOtech-java.lang.String-">WriteToIOtech</a></span>(java.lang.String&nbsp;Msg)</code>
<div class="block">Sends the given String to the IOtech GPIB-RS232 controller.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.icontrol.drivers.GPIB_Driver">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;icontrol.drivers.<a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></h3>
<code><a href="../../icontrol/drivers/GPIB_Driver.html#SpeedTest-int-">SpeedTest</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="m_Logger">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>m_Logger</h4>
<pre>private static final&nbsp;java.util.logging.Logger m_Logger</pre>
<div class="block">The Logger for this class</div>
</li>
</ul>
<a name="m_iC_Properties">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>m_iC_Properties</h4>
<pre>protected static&nbsp;<a href="../../icontrol/iC_Properties.html" title="class in icontrol">iC_Properties</a> m_iC_Properties</pre>
<div class="block">Grants access to global properties in a resource bundle file 'iC.properties'</div>
</li>
</ul>
<a name="m_GPIB_Adr">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>m_GPIB_Adr</h4>
<pre>private&nbsp;int m_GPIB_Adr</pre>
<div class="block">GPIB Address of the Instrument</div>
</li>
</ul>
<a name="m_RS232Driver">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>m_RS232Driver</h4>
<pre>private&nbsp;<a href="../../icontrol/drivers/RS232_Driver.html" title="class in icontrol.drivers">RS232_Driver</a> m_RS232Driver</pre>
<div class="block">Handle to access the RS232 port</div>
</li>
</ul>
<a name="m_LastError">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>m_LastError</h4>
<pre>private&nbsp;java.lang.String m_LastError</pre>
<div class="block">Stores the status (error) of the last communication with the IOtech
 controller. Assigned in <code>checkCommunicationError</code> and used
 in <code>getGPIBStatus</code>.</div>
</li>
</ul>
<a name="m_IOtechDebug">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>m_IOtechDebug</h4>
<pre>private final&nbsp;boolean m_IOtechDebug</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="GPIB_IOtech--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>GPIB_IOtech</h4>
<pre>protected&nbsp;GPIB_IOtech()
               throws java.io.IOException</pre>
<div class="block">Constructor. Does some initializations and calls <code>OpenRS232</code>
 to open the RS232 port. <code>OpenRS232</code> calls <code>InitIOtech</code>
 to initializes the Micro 488 GPIB controller.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - bubbles up from <code>OpenRS232</code>.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="checkCommunicationError-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkCommunicationError</h4>
<pre>private&nbsp;void&nbsp;checkCommunicationError(java.lang.String&nbsp;Msg)
                              throws java.io.IOException</pre>
<div class="block">Checks the Status of the last communication with the IOtech controller
 and throws an Exception if an error occurred.<p>
 
 If an error occurred, this event is also Logged with level SEVERE. IOtech's
 system command STATUS 1 is used to determine if an error occurred. It is 
 recommended to call this method after each invocation of
 <code>WriteToIOtech</code>.<p>
 
 The error message is also stored in a member variable and used in 
 <code>getGPIBStatus</code> to return the GPIB status of the last
 GPIB communication.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>Msg</code> - This String is appended to the message thrown as an
 Exception when an error occurred.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - when an error occurred during the last GPIB operation
 or the reported Status of the IOtech controller was invalid.</dd>
</dl>
</li>
</ul>
<a name="OpenRS232--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>OpenRS232</h4>
<pre>protected final&nbsp;void&nbsp;OpenRS232()
                        throws java.io.IOException</pre>
<div class="block">Opens the RS232 port using the parameters defined in 
 <code>iC.Properties</code>. It also calls <code>InitIOtech</code> which
 initializes the GPIB controller (e.g. to make it controller in charge etc.)</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When 1) opening the RS232 port with the specified
 communication parameters failed, or 2) an exception was thrown in 
 <code>initIOtech</code>.</dd>
</dl>
</li>
</ul>
<a name="InitIOtech--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>InitIOtech</h4>
<pre>private&nbsp;void&nbsp;InitIOtech()
                 throws java.io.IOException</pre>
<div class="block">Initializes the IOtech Micro 488 GPIB-RS232 controller to it's power-on
 state (command @@), becomes controller-in-charge (ABORT). The response to the
 HELLO-command is logged. It also sets the serial termination character 
 (STERM, p. 4-65) to none (the data can contain any value between 0-255), 
 and sets the time-out value.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When communicating with the IOtech controller failed.</dd>
</dl>
</li>
</ul>
<a name="CloseController--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CloseController</h4>
<pre>protected&nbsp;void&nbsp;CloseController()
                        throws java.io.IOException</pre>
<div class="block">Closes the connection to the GPIB controller by closing the RS232 port. 
 This method is called from <code>Dispatcher.run</code> after the Script 
 has been processed.<p>
 
 The IOtech GPIB controller cannot be switched into a passive mode like
 the NI or the Prologix GPIB controllers. Hence, it is not possible to
 not be the active System Controller and allow for multiple GPIB controllers
 to be attached at the same time. The command would be PASS CONTROL on 
 page 4-45.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../icontrol/drivers/GPIB_Driver.html#CloseController--">CloseController</a></code>&nbsp;in class&nbsp;<code><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When the closing caused a GPIB error</dd>
</dl>
</li>
</ul>
<a name="Open-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Open</h4>
<pre>protected&nbsp;void&nbsp;Open(int&nbsp;GPIB_Address)
             throws java.io.IOException</pre>
<div class="block">Opens the connection to the Instrument at the specified GPIB address.<p>

 Because there are no special requirements to open an instrument, only a
 Selected Device Clear is sent.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../icontrol/drivers/GPIB_Driver.html#Open-int-">Open</a></code>&nbsp;in class&nbsp;<code><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>GPIB_Address</code> - The primary GPIB address of the Instrument</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When a GPIB transaction caused a GPIB error (bubbles
 up from <code>checkErrorGPIB</code>.</dd>
</dl>
</li>
</ul>
<a name="WriteToIOtech-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WriteToIOtech</h4>
<pre>private&nbsp;void&nbsp;WriteToIOtech(java.lang.String&nbsp;Msg)
                    throws java.io.IOException</pre>
<div class="block">Sends the given String to the IOtech GPIB-RS232 controller. A newline
 character (\n) is appended to <code>Msg</code> if none is present already
 to terminate serial transmission (see STERM in IOtech's manual).<p>
 
 To check for communication errors, use <code>checkCommunicationError</code> 
 after each use of <code>WriteToIOtech</code> (with a few exceptions in 
 <code>InitIOtech</code> for instance).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>Msg</code> - The data to be sent. A newline character will be appended if none
 is present to indicate the end of transmission via RS232.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When the transmission caused an error</dd>
</dl>
</li>
</ul>
<a name="Send-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Send</h4>
<pre>protected&nbsp;long&nbsp;Send(java.lang.String&nbsp;Msg)
             throws java.io.IOException</pre>
<div class="block">Sends the given String via the GPIB bus to the Instrument specified in
 <code>Open</code>. If <code>Msg</code> is empty, the method returns immediately.<p></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../icontrol/drivers/GPIB_Driver.html#Send-java.lang.String-">Send</a></code>&nbsp;in class&nbsp;<code><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>Msg</code> - Data to be sent</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The length of <code>Msg</code> because the actual number of bytes
 sent is not reported by the IOtech controller.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When the transmission caused a GPIB error</dd>
</dl>
</li>
</ul>
<a name="getGPIBStatus--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getGPIBStatus</h4>
<pre>protected&nbsp;java.lang.String&nbsp;getGPIBStatus()</pre>
<div class="block">Returns the status of the last communication with the IOtech controller.
 The last status is stored in a member variable in method
 <code>checkCommunicationError</code>, which should be called each time
 after invoking <code>WriteToIOtech</code>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../icontrol/drivers/GPIB_Driver.html#getGPIBStatus--">getGPIBStatus</a></code>&nbsp;in class&nbsp;<code><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>When an error occurred during the last GPIB call, the returned
 String contains a somewhat helpful explanation of what went
 wrong. An empty String is returned if no error occurred.</dd>
</dl>
</li>
</ul>
<a name="ReadFromIOtech--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ReadFromIOtech</h4>
<pre>private&nbsp;java.lang.String&nbsp;ReadFromIOtech()
                                 throws java.io.IOException</pre>
<div class="block">Read data from the IOtech GPIB-RS232 controller until no more data was 
 received via RS232 for a time-out period specified in 
 <code>iC.properties / RS232_Driver.TimeOut</code>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The data read from the controller. The String's length equals
 the number of bytes received from the IOtech controller.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When the transmission caused an error (bubbles up from
 <code>RS232_Driver.Receive</code>.</dd>
</dl>
</li>
</ul>
<a name="Receive-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Receive</h4>
<pre>protected&nbsp;java.lang.String&nbsp;Receive(boolean&nbsp;Trim)
                            throws java.io.IOException</pre>
<div class="block">Receives data from the Instrument specified in <code>Open</code>. This 
 method returns when no data was received via the RS232 port for a time-out
 value specified in RS232_Driver.TimeOut in the iC.properties.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../icontrol/drivers/GPIB_Driver.html#Receive-boolean-">Receive</a></code>&nbsp;in class&nbsp;<code><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>Trim</code> - If <code>true</code>, newline (\n) and carriage return (\r)
 characters are removed from the end of the returned String.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The data bytes sent by the Instrument wrapped in a String.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When a transmission error occurred (bubbles up from
 <code>WriteToIOtech</code> or <code>ReadFromIOtech</code></dd>
</dl>
</li>
</ul>
<a name="ReadStatusByte--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ReadStatusByte</h4>
<pre>public&nbsp;int&nbsp;ReadStatusByte()
                   throws java.io.IOException</pre>
<div class="block">Reads the Status Byte of the Instrument defined in <code>Open</code>
 by serially polling the Instrument. <code>Open</code> must have been
 called before calling this method.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../icontrol/drivers/GPIB_Driver.html#ReadStatusByte--">ReadStatusByte</a></code>&nbsp;in class&nbsp;<code><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The Status Byte of the Instrument.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When the transmission caused a GPIB error or the
 received Status Byte could not be converted into an Integer value.</dd>
</dl>
</li>
</ul>
<a name="CloseInstrument--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CloseInstrument</h4>
<pre>protected&nbsp;void&nbsp;CloseInstrument()
                        throws java.io.IOException</pre>
<div class="block">Closes the connection to the Instrument specified in <code>Open</code>.
 This method is called from <code>Dispatcher.run</code> after the Script
 has been processed.<p>

 This method switches the Instrument to a local mode.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../icontrol/drivers/GPIB_Driver.html#CloseInstrument--">CloseInstrument</a></code>&nbsp;in class&nbsp;<code><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers">GPIB_Driver</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - When the closing caused a GPIB error</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/GPIB_IOtech.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../icontrol/drivers/GPIB_Driver.html" title="class in icontrol.drivers"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../icontrol/drivers/GPIB_NI.html" title="class in icontrol.drivers"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?icontrol/drivers/GPIB_IOtech.html" target="_top">Frames</a></li>
<li><a href="GPIB_IOtech.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
